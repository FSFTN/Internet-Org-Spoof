/*! skrollr 0.6.29 (2014-11-17) | Alexander Prinzhorn - https://github.com/Prinzhorn/skrollr | Free to use under terms of MIT license */

function fitMainVideo(){$("#main").toggleClass("fullscreen-video-mode"),mainVideoDimensionFunction($("#video-container")),$("#main").hasClass("fullscreen-video-mode")?$(".fullscreen-video").width($(window).width()):$(".fullscreen-video").width("100%")}function dimensionFunction(e,t){var n=e[0].videoHeight/e[0].videoWidth,r=t.height()/t.width();n>r?(e.width(t.width()),e.height("auto")):(e.height(t.height()),e.width("auto"))}function lazyLoadImages(){$(".lazyload-img").each(function(e,t){$(t).css("background-image",$(t).attr("data-background-image"))})}function lazyLoadVideos(){}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e))+e}function bannerRotateUpdates(){var e=$("#banner .update"),t=e.length-1,n=0;setInterval(function(){$("#updates-wrapper").fadeOut(300,function(){e.eq(n).hide(),++n>t&&(n=0),e.eq(n).show(),$("#updates-wrapper").fadeIn(300),$("#banner").attr("href",e.eq(n).attr("data-href"))})},1e3*t)}function mainVideoDimensionFunction(e){var t=$("#story1_video_html5_api")[0].videoHeight/$("#story1_video_html5_api")[0].videoWidth,n=e.height()/e.width();t>n?($("#story1_video_html5_api").width(e.width()*1.08),$("#story1_video_html5_api").height("auto")):($("#story1_video_html5_api").height(e.height()*1.08),$("#story1_video_html5_api").width("auto"))}define("app",[],function(e){var t={};return t}),function(e,t,n){function r(n){if(i=t.documentElement,s=t.body,X(),ut=this,n=n||{},ht=n.constants||{},n.easing)for(var r in n.easing)J[r]=n.easing[r];bt=n.edgeStrategy||"set",lt={beforerender:n.beforerender,render:n.render,keyframe:n.keyframe},ct=n.forceHeight!==!1,ct&&(Bt=n.scale||1),pt=n.mobileDeceleration||T,vt=n.smoothScrolling!==!1,mt=n.smoothScrollingDuration||C,gt={targetTop:ut.getScrollTop()},Wt=(n.mobileCheck||function(){return/Android|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent||navigator.vendor||e.opera)})(),Wt?(ft=t.getElementById(n.skrollrBody||N),ft&&ot(),K(),Ot(i,[y,E],[b])):Ot(i,[y,w],[b]),ut.refresh(),St(e,"resize orientationchange",function(){var e=i.clientWidth,t=i.clientHeight;(t!==Rt||e!==qt)&&(Rt=t,qt=e,Ut=!0)});var o=V();return function u(){Y(),Et=o(u)}(),ut}var i,s,o={get:function(){return ut},init:function(e){return ut||new r(e)},VERSION:"0.6.29"},u=Object.prototype.hasOwnProperty,a=e.Math,f=e.getComputedStyle,l="touchstart",c="touchmove",h="touchcancel",p="touchend",d="skrollable",v=d+"-before",m=d+"-between",g=d+"-after",y="skrollr",b="no-"+y,w=y+"-desktop",E=y+"-mobile",S="linear",x=1e3,T=.004,N="skrollr-body",C=200,k="start",L="end",A="center",O="bottom",M="___skrollable_id",_=/^(?:input|textarea|button|select)$/i,D=/^\s+|\s+$/g,P=/^data(?:-(_\w+))?(?:-?(-?\d*\.?\d+p?))?(?:-?(start|end|top|center|bottom))?(?:-?(top|center|bottom))?$/,H=/\s*(@?[\w\-\[\]]+)\s*:\s*(.+?)\s*(?:;|$)/gi,B=/^(@?[a-z\-]+)\[(\w+)\]$/,j=/-([a-z0-9_])/g,F=function(e,t){return t.toUpperCase()},I=/[\-+]?[\d]*\.?[\d]+/g,q=/\{\?\}/g,R=/rgba?\(\s*-?\d+\s*,\s*-?\d+\s*,\s*-?\d+/g,U=/[a-z\-]+-gradient/g,z="",W="",X=function(){var e=/^(?:O|Moz|webkit|ms)|(?:-(?:o|moz|webkit|ms)-)/;if(f){var t=f(s,null);for(var r in t)if(z=r.match(e)||+r==r&&t[r].match(e))break;if(!z)return z=W="",n;z=z[0],"-"===z.slice(0,1)?(W=z,z={"-webkit-":"webkit","-moz-":"Moz","-ms-":"ms","-o-":"O"}[z]):W="-"+z.toLowerCase()+"-"}},V=function(){var t=e.requestAnimationFrame||e[z.toLowerCase()+"RequestAnimationFrame"],n=Dt();return(Wt||!t)&&(t=function(t){var r=Dt()-n,i=a.max(0,1e3/60-r);return e.setTimeout(function(){n=Dt(),t()},i)}),t},$=function(){var t=e.cancelAnimationFrame||e[z.toLowerCase()+"CancelAnimationFrame"];return(Wt||!t)&&(t=function(t){return e.clearTimeout(t)}),t},J={begin:function(){return 0},end:function(){return 1},linear:function(e){return e},quadratic:function(e){return e*e},cubic:function(e){return e*e*e},swing:function(e){return-a.cos(e*a.PI)/2+.5},sqrt:function(e){return a.sqrt(e)},outCubic:function(e){return a.pow(e-1,3)+1},bounce:function(e){var t;if(.5083>=e)t=3;else if(.8489>=e)t=9;else if(.96208>=e)t=27;else{if(!(.99981>=e))return 1;t=91}return 1-a.abs(3*a.cos(1.028*e*t)/t)}};r.prototype.refresh=function(e){var r,i,s=!1;for(e===n?(s=!0,at=[],zt=0,e=t.getElementsByTagName("*")):e.length===n&&(e=[e]),r=0,i=e.length;i>r;r++){var o=e[r],u=o,a=[],f=vt,l=bt,c=!1;if(s&&M in o&&delete o[M],o.attributes){for(var h=0,p=o.attributes.length;p>h;h++){var v=o.attributes[h];if("data-anchor-target"!==v.name)if("data-smooth-scrolling"!==v.name)if("data-edge-strategy"!==v.name)if("data-emit-events"!==v.name){var m=v.name.match(P);if(null!==m){var g={props:v.value,element:o,eventType:v.name.replace(j,F)};a.push(g);var y=m[1];y&&(g.constant=y.substr(1));var b=m[2];/p$/.test(b)?(g.isPercentage=!0,g.offset=(0|b.slice(0,-1))/100):g.offset=0|b;var w=m[3],E=m[4]||w;w&&w!==k&&w!==L?(g.mode="relative",g.anchors=[w,E]):(g.mode="absolute",w===L?g.isEnd=!0:g.isPercentage||(g.offset=g.offset*Bt))}}else c=!0;else l=v.value;else f="off"!==v.value;else if(u=t.querySelector(v.value),null===u)throw'Unable to find anchor target "'+v.value+'"'}if(a.length){var S,x,T;!s&&M in o?(T=o[M],S=at[T].styleAttr,x=at[T].classAttr):(T=o[M]=zt++,S=o.style.cssText,x=At(o)),at[T]={element:o,styleAttr:S,classAttr:x,anchorTarget:u,keyFrames:a,smoothScrolling:f,edgeStrategy:l,emitEvents:c,lastFrameIndex:-1},Ot(o,[d],[])}}}for(Ct(),r=0,i=e.length;i>r;r++){var N=at[e[r][M]];N!==n&&(Z(N),tt(N))}return ut},r.prototype.relativeToAbsolute=function(e,t,n){var r=i.clientHeight,s=e.getBoundingClientRect(),o=s.top,u=s.bottom-s.top;return t===O?o-=r:t===A&&(o-=r/2),n===O?o+=u:n===A&&(o+=u/2),o+=ut.getScrollTop(),0|o+.5},r.prototype.animateTo=function(e,t){t=t||{};var r=Dt(),i=ut.getScrollTop();return dt={startTop:i,topDiff:e-i,targetTop:e,duration:t.duration||x,startTime:r,endTime:r+(t.duration||x),easing:J[t.easing||S],done:t.done},dt.topDiff||(dt.done&&dt.done.call(ut,!1),dt=n),ut},r.prototype.stopAnimateTo=function(){dt&&dt.done&&dt.done.call(ut,!0),dt=n},r.prototype.isAnimatingTo=function(){return!!dt},r.prototype.isMobile=function(){return Wt},r.prototype.setScrollTop=function(t,n){return yt=n===!0,Wt?Xt=a.min(a.max(t,0),Ht):e.scrollTo(0,t),ut},r.prototype.getScrollTop=function(){return Wt?Xt:e.pageYOffset||i.scrollTop||s.scrollTop||0},r.prototype.getMaxScrollTop=function(){return Ht},r.prototype.on=function(e,t){return lt[e]=t,ut},r.prototype.off=function(e){return delete lt[e],ut},r.prototype.destroy=function(){var e=$();e(Et),Tt(),Ot(i,[b],[y,w,E]);for(var t=0,r=at.length;r>t;t++)st(at[t].element);i.style.overflow=s.style.overflow="",i.style.height=s.style.height="",ft&&o.setStyle(ft,"transform","none"),ut=n,ft=n,lt=n,ct=n,Ht=0,Bt=1,ht=n,pt=n,jt="down",Ft=-1,qt=0,Rt=0,Ut=!1,dt=n,vt=n,mt=n,gt=n,yt=n,zt=0,bt=n,Wt=!1,Xt=0,wt=n};var K=function(){var r,o,u,f,d,v,m,g,y,b,w,E;St(i,[l,c,h,p].join(" "),function(e){var i=e.changedTouches[0];for(f=e.target;3===f.nodeType;)f=f.parentNode;switch(d=i.clientY,v=i.clientX,b=e.timeStamp,_.test(f.tagName)||e.preventDefault(),e.type){case l:r&&r.blur(),ut.stopAnimateTo(),r=f,o=m=d,u=v,y=b;break;case c:_.test(f.tagName)&&t.activeElement!==f&&e.preventDefault(),g=d-m,E=b-w,ut.setScrollTop(Xt-g,!0),m=d,w=b;break;default:case h:case p:var s=o-d,S=u-v,x=S*S+s*s;if(49>x){if(!_.test(r.tagName)){r.focus();var T=t.createEvent("MouseEvents");T.initMouseEvent("click",!0,!0,e.view,1,i.screenX,i.screenY,i.clientX,i.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),r.dispatchEvent(T)}return}r=n;var N=g/E;N=a.max(a.min(N,3),-3);var C=a.abs(N/pt),k=N*C+.5*pt*C*C,L=ut.getScrollTop()-k,A=0;L>Ht?(A=(Ht-L)/k,L=Ht):0>L&&(A=-L/k,L=0),C*=1-A,ut.animateTo(0|L+.5,{easing:"outCubic",duration:C})}}),e.scrollTo(0,0),i.style.overflow=s.style.overflow="hidden"},Q=function(){var e,t,n,r,s,o,u,f,l,c,h,p=i.clientHeight,d=kt();for(f=0,l=at.length;l>f;f++)for(e=at[f],t=e.element,n=e.anchorTarget,r=e.keyFrames,s=0,o=r.length;o>s;s++)u=r[s],c=u.offset,h=d[u.constant]||0,u.frame=c,u.isPercentage&&(c*=p,u.frame=c),"relative"===u.mode&&(st(t),u.frame=ut.relativeToAbsolute(n,u.anchors[0],u.anchors[1])-c,st(t,!0)),u.frame+=h,ct&&!u.isEnd&&u.frame>Ht&&(Ht=u.frame);for(Ht=a.max(Ht,Lt()),f=0,l=at.length;l>f;f++){for(e=at[f],r=e.keyFrames,s=0,o=r.length;o>s;s++)u=r[s],h=d[u.constant]||0,u.isEnd&&(u.frame=Ht-u.offset+h);e.keyFrames.sort(Pt)}},G=function(e,t){for(var n=0,r=at.length;r>n;n++){var i,s,a=at[n],f=a.element,l=a.smoothScrolling?e:t,c=a.keyFrames,h=c.length,p=c[0],y=c[c.length-1],b=p.frame>l,w=l>y.frame,E=b?p:y,S=a.emitEvents,x=a.lastFrameIndex;if(b||w){if(b&&-1===a.edge||w&&1===a.edge)continue;switch(b?(Ot(f,[v],[g,m]),S&&x>-1&&(Nt(f,p.eventType,jt),a.lastFrameIndex=-1)):(Ot(f,[g],[v,m]),S&&h>x&&(Nt(f,y.eventType,jt),a.lastFrameIndex=h)),a.edge=b?-1:1,a.edgeStrategy){case"reset":st(f);continue;case"ease":l=E.frame;break;default:case"set":var T=E.props;for(i in T)u.call(T,i)&&(s=it(T[i].value),0===i.indexOf("@")?f.setAttribute(i.substr(1),s):o.setStyle(f,i,s));continue}}else 0!==a.edge&&(Ot(f,[d,m],[v,g]),a.edge=0);for(var N=0;h-1>N;N++)if(l>=c[N].frame&&c[N+1].frame>=l){var C=c[N],k=c[N+1];for(i in C.props)if(u.call(C.props,i)){var L=(l-C.frame)/(k.frame-C.frame);L=C.props[i].easing(L),s=rt(C.props[i].value,k.props[i].value,L),s=it(s),0===i.indexOf("@")?f.setAttribute(i.substr(1),s):o.setStyle(f,i,s)}S&&x!==N&&("down"===jt?Nt(f,C.eventType,jt):Nt(f,k.eventType,jt),a.lastFrameIndex=N);break}}},Y=function(){Ut&&(Ut=!1,Ct());var e,t,r=ut.getScrollTop(),i=Dt();if(dt)i>=dt.endTime?(r=dt.targetTop,e=dt.done,dt=n):(t=dt.easing((i-dt.startTime)/dt.duration),r=0|dt.startTop+t*dt.topDiff),ut.setScrollTop(r,!0);else if(!yt){var s=gt.targetTop-r;s&&(gt={startTop:Ft,topDiff:r-Ft,targetTop:r,startTime:It,endTime:It+mt}),gt.endTime>=i&&(t=J.sqrt((i-gt.startTime)/mt),r=0|gt.startTop+t*gt.topDiff)}if(Wt&&ft&&o.setStyle(ft,"transform","translate(0, "+ -Xt+"px) "+wt),yt||Ft!==r){jt=r>Ft?"down":Ft>r?"up":jt,yt=!1;var u={curTop:r,lastTop:Ft,maxTop:Ht,direction:jt},a=lt.beforerender&&lt.beforerender.call(ut,u);a!==!1&&(G(r,ut.getScrollTop()),Ft=r,lt.render&&lt.render.call(ut,u)),e&&e.call(ut,!1)}It=i},Z=function(e){for(var t=0,n=e.keyFrames.length;n>t;t++){for(var r,i,s,o,u=e.keyFrames[t],a={};null!==(o=H.exec(u.props));)s=o[1],i=o[2],r=s.match(B),null!==r?(s=r[1],r=r[2]):r=S,i=i.indexOf("!")?et(i):[i.slice(1)],a[s]={value:i,easing:J[r]};u.props=a}},et=function(e){var t=[];return R.lastIndex=0,e=e.replace(R,function(e){return e.replace(I,function(e){return 100*(e/255)+"%"})}),W&&(U.lastIndex=0,e=e.replace(U,function(e){return W+e})),e=e.replace(I,function(e){return t.push(+e),"{?}"}),t.unshift(e),t},tt=function(e){var t,n,r={};for(t=0,n=e.keyFrames.length;n>t;t++)nt(e.keyFrames[t],r);for(r={},t=e.keyFrames.length-1;t>=0;t--)nt(e.keyFrames[t],r)},nt=function(e,t){var n;for(n in t)u.call(e.props,n)||(e.props[n]=t[n]);for(n in e.props)t[n]=e.props[n]},rt=function(e,t,n){var r,i=e.length;if(i!==t.length)throw"Can't interpolate between \""+e[0]+'" and "'+t[0]+'"';var s=[e[0]];for(r=1;i>r;r++)s[r]=e[r]+(t[r]-e[r])*n;return s},it=function(e){var t=1;return q.lastIndex=0,e[0].replace(q,function(){return e[t++]})},st=function(e,t){e=[].concat(e);for(var n,r,i=0,s=e.length;s>i;i++)r=e[i],n=at[r[M]],n&&(t?(r.style.cssText=n.dirtyStyleAttr,Ot(r,n.dirtyClassAttr)):(n.dirtyStyleAttr=r.style.cssText,n.dirtyClassAttr=At(r),r.style.cssText=n.styleAttr,Ot(r,n.classAttr)))},ot=function(){wt="translateZ(0)",o.setStyle(ft,"transform",wt);var e=f(ft),t=e.getPropertyValue("transform"),n=e.getPropertyValue(W+"transform"),r=t&&"none"!==t||n&&"none"!==n;r||(wt="")};o.setStyle=function(e,t,n){var r=e.style;if(t=t.replace(j,F).replace("-",""),"zIndex"===t)r[t]=isNaN(n)?n:""+(0|n);else if("float"===t)r.styleFloat=r.cssFloat=n;else try{z&&(r[z+t.slice(0,1).toUpperCase()+t.slice(1)]=n),r[t]=n}catch(i){}};var ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St=o.addEvent=function(t,n,r){var i=function(t){return t=t||e.event,t.target||(t.target=t.srcElement),t.preventDefault||(t.preventDefault=function(){t.returnValue=!1,t.defaultPrevented=!0}),r.call(this,t)};n=n.split(" ");for(var s,o=0,u=n.length;u>o;o++)s=n[o],t.addEventListener?t.addEventListener(s,r,!1):t.attachEvent("on"+s,i),Vt.push({element:t,name:s,listener:r})},xt=o.removeEvent=function(e,t,n){t=t.split(" ");for(var r=0,i=t.length;i>r;r++)e.removeEventListener?e.removeEventListener(t[r],n,!1):e.detachEvent("on"+t[r],n)},Tt=function(){for(var e,t=0,n=Vt.length;n>t;t++)e=Vt[t],xt(e.element,e.name,e.listener);Vt=[]},Nt=function(e,t,n){lt.keyframe&&lt.keyframe.call(ut,e,t,n)},Ct=function(){var e=ut.getScrollTop();Ht=0,ct&&!Wt&&(s.style.height=""),Q(),ct&&!Wt&&(s.style.height=Ht+i.clientHeight+"px"),Wt?ut.setScrollTop(a.min(ut.getScrollTop(),Ht)):ut.setScrollTop(e,!0),yt=!0},kt=function(){var e,t,n=i.clientHeight,r={};for(e in ht)t=ht[e],"function"==typeof t?t=t.call(ut):/p$/.test(t)&&(t=t.slice(0,-1)/100*n),r[e]=t;return r},Lt=function(){var e,t=0;return ft&&(t=a.max(ft.offsetHeight,ft.scrollHeight)),e=a.max(t,s.scrollHeight,s.offsetHeight,i.scrollHeight,i.offsetHeight,i.clientHeight),e-i.clientHeight},At=function(t){var n="className";return e.SVGElement&&t instanceof e.SVGElement&&(t=t[n],n="baseVal"),t[n]},Ot=function(t,r,i){var s="className";if(e.SVGElement&&t instanceof e.SVGElement&&(t=t[s],s="baseVal"),i===n)return t[s]=r,n;for(var o=t[s],u=0,a=i.length;a>u;u++)o=_t(o).replace(_t(i[u])," ");o=Mt(o);for(var f=0,l=r.length;l>f;f++)-1===_t(o).indexOf(_t(r[f]))&&(o+=" "+r[f]);t[s]=Mt(o)},Mt=function(e){return e.replace(D,"")},_t=function(e){return" "+e+" "},Dt=Date.now||function(){return+(new Date)},Pt=function(e,t){return e.frame-t.frame},Ht=0,Bt=1,jt="down",Ft=-1,It=Dt(),qt=0,Rt=0,Ut=!1,zt=0,Wt=!1,Xt=0,Vt=[];"function"==typeof define&&define.amd?define("skrollr",[],function(){return o}):"undefined"!=typeof module&&module.exports?module.exports=o:e.skrollr=o}(window,document),define("desktop",["skrollr","app"],function(e,t){var n=function(){this.init()};return n.prototype.init=function(){var n=0,r=["/assets/images/homepage/masks/ee.jpg","/assets/images/homepage/masks/mm.jpg","/assets/images/homepage/masks/neesha.jpg","/assets/images/homepage/masks/lian.jpg"];$(document).ready(function(){var i=$(window).height(),s=i/2;$(window).scrollTop()>50&&$(".fade-out-after-scroll").fadeOut(300),isIE10&&$("html").addClass("ie10");var o=navigator.userAgent.indexOf("Chrome")>-1,u=navigator.userAgent.indexOf("Safari")>-1,a=navigator.userAgent.indexOf("Mac OS")!=-1,f=!a;o&&u&&(u=!1),(u||f)&&$("body").css("-webkit-text-stroke","0.5px"),$("video").bind("contextmenu",function(){return!1}),$(".abovefold-caret-down, .explore-more").click(function(){$(this).fadeOut(300);var e=$("html, body");e.animate({scrollTop:$(window).height()-160},"500","linear",function(){})}),$("#menu-cta").on("click",function(e){e.preventDefault(),$(this).toggleClass("close"),$("#menu").toggleClass("active")});if($("#main.homepage").length){var l=0,c=$("#home-globe");t.newsBanner.init(),c[0].playbackRate=.6,e.init({smoothScrolling:!1,mobileDeceleration:.004,constants:{globe:function(){return $("#intro").height()-$(window).height()-150},storiestop:function(){return $("#stories-gallery").offset().top}}});var h=getRandomInt(0,r.length);$("#preload-img").hide().one("load",function(){$(this).remove(),$(".fb-loader-wrapper").fadeOut(600,function(){$("body").addClass("show-top-banner"),window.location.hash==="#stories"&&setTimeout(function(){$("html,body").animate({scrollTop:$("#stories-gallery").offset().top},1e3)},300)}),$("#intro .homepage-bg").css("background-image","url("+r[h]+")")}).attr("src",r[h]).each(function(){this.complete&&$(this).trigger("load")})}if($("#main.story1").length){var p=$("#tools").offset().top-$(".desktop-header").height();e.init({smoothScrolling:!1,mobileDeceleration:.004,constants:{legotop:function(){return $("#lego").offset().top-.4*$(window).height()},legobottom:function(){return $("#lego").offset().top-.2*$(window).height()},toolstop:function(){return $("#tools").offset().top-.5*$(window).height()},toolsbottom:function(){return $("#tools").offset().top-.2*$(window).height()},dancetop:function(){return $("#dance").offset().top-.2*$(window).height()},dancebottom:function(){return $("#dance").offset().top-0*$(window).height()},progresstop:function(){return $("#progress").offset().top-1*$(window).height()},progressbottom:function(){return $("#progress").offset().top+$("#progress").height()}}}),setTimeout(function(){lazyLoadImages(),lazyLoadVideos()},1e3);if($("#page-wrapper.story3").length){var d=$("#color-windmill").offset().top-200;$(window).scroll(function(){$(window).scrollTop()>d&&$("#color-windmill").addClass("active")}),$("#white-windmill video")[0].playbackRate=.45}$("#main-video-poster-preload").hide().one("load",function(){console.log("main-video-poster-preload - loaded"),$(".fb-loader-wrapper").fadeOut(600)}).attr("src",$("#main-video-poster-preload").attr("data-src")).each(function(){this.complete&&$(this).trigger("load")}),$(".desk-video-cover")[0].addEventListener("playing",function(){$(".main-video-poster,.fb-loader-wrapper").fadeOut(400)},!1);var v;$("#story1_video").length&&(videojs("story1_video").ready(function(){v=this,$(".btn-play-wrapper").click(function(e){$(".fade-out-after-scroll").fadeOut(300),$("#video-container .vjs-control-bar,#story1_video").fadeIn(300),v.play(),$("body").addClass("main-video-mode"),$("#main .intro,#main .black-bg,.desk-video-cover ").fadeOut(600),fitMainVideo()})}),videojs("story1_video").on("playing",function(){mainVideoDimensionFunction($("#video-container"))}),videojs("story1_video").on("play",function(){$("#story1_video").hasClass("no-fullscreen")||$(".btn-fullscreen-video").show(),$("#main .share-video").fadeOut(300),$("#video-container .vjs-control-bar").fadeIn(300)}),videojs("story1_video").on("ended",function(){$(".btn-fullscreen-video").hide(),$("#main .share-video").fadeIn(600),$("#video-container .vjs-control-bar").fadeOut(300),t.analytics.trackEvent("story-video","video-watch",$("#story1_video").data("story")+"-ended")}),videojs("story1_video").on("timeupdate",function(){var e=parseInt(this.F.currentTime);e!==0&&e%5==0&&n!==e&&(n=e,t.analytics.trackEvent("story-video","video-watch",$("#story1_video").data("story")+"-watch-"+e+"-seconds"))})),$(".vjs-control-bar").after($(".btn-fullscreen-video")),$(".btn-fullscreen-video").click(function(e){e.preventDefault(),e.stopPropagation(),$(".vjs-fullscreen-control").click()}),$(window).resize(function(){$(".fullscreen-video").each(function(e,t){dimensionFunction($(t),$(t).parent())}),mainVideoDimensionFunction($("#video-container")),p=$("#tools").offset().top-$(".desktop-header").height()}),$(".back-to-stories").click(function(e){$("body").hasClass("main-video-mode")&&(e.preventDefault(),e.stopPropagation(),$("body").removeClass("main-video-mode"),$("#main .intro,.desk-video-cover ").fadeIn(300),$("#main .share-video").fadeOut(300),v.pause(),v.currentTime(0))}),$(".btn-replay").click(function(e){e.preventDefault(),e.stopPropagation(),$("#video-container .vjs-control-bar").fadeIn(300),$("#main .share-video").fadeOut(300),mainVideoDimensionFunction($("#video-container")),v.currentTime(0),v.play()}),$(".fullscreen-video").each(function(e,t){t.addEventListener("loadeddata",function(){dimensionFunction($(t),$(t).parent())},!1),dimensionFunction($(t),$(t).parent())})}var m,g=$("body"),y=$(".fade-out-after-scroll");$(window).scroll(function(){m=$(window).scrollTop(),m<5?g.addClass("at-top"):m>200&&(g.removeClass("at-top"),y.fadeOut(300)),m>s&&g.addClass("page2"),$(".pause-off-view.skrollable-between.paused").each(function(e,t){$(t).removeClass("paused").addClass("playing"),$(t).find("video")[0].play()}),$(".pause-off-view.skrollable-after.playing,.pause-off-view.skrollable-before.playing").each(function(e,t){$(t).addClass("paused").removeClass("playing"),$(t).find("video")[0].pause()}),$(".intro").is(":visible")||(m>p?g.removeClass("main-video-mode"):g.addClass("main-video-mode"))})})},n}),define("common/analytics",[],function(){var e=function(){console.log("Analytics initialized"),this.addListener()};return e.prototype.addListener=function(){var e=this;$(document).on("click","*[data-ga]",function(t){var n=$(this).attr("href"),r=$.trim($(this).attr("data-ga").split(",")[0]),i=$.trim($(this).attr("data-ga").split(",")[1])||"click",s=$.trim($(this).attr("data-ga").split(",")[2]),o=$.trim($(this).attr("data-ga").split(",")[3])||"",u=$(this).attr("target"),a=$(this).is("button"),f=$(this),l=null;return console.log("Track data-ga (ga): "+r+", "+i+", "+s+", "+o),t.preventDefault(),l=function(){n!=="#"&&(typeof u=="undefined"?window.location=n:window.open(n,u))},e.trackEvent(r,i,s,o),setTimeout(l,150),!1})},e.prototype.trackPageView=function(e){console.log("track page view: "+e),_gaq.push(["_trackPageview",e])},e.prototype.trackEvent=function(e,t,n){console.log("track event: "+e+", "+t+", "+n),_gaq.push(["_trackEvent",e,t,n])},e}),define("newsBanner",[],function(){var e=function(){};return e.prototype.init=function(){$.ajax({url:"/api/news",success:function(e){e.data.length===0?$("#banner").hide():$("#banner").attr("href",e.data[0].url),$.each(e.data,function(e,t){$("#updates-wrapper").append('<div class="update" data-href="'+t.url+'">'+"<span>"+t.copy+"</span>"+'<span class="arrow"><em class="fa fa-chevron-right"></em></span>'+"</div>")}),bannerRotateUpdates()},dataType:"json"})},e}),require.config({paths:{newsBanner:"common/news-banner",tweenMax:"libs/greensock/TweenMax.min",preloadjs:"libs/createjs/preloadjs-0.6.0.min",skrollr:"libs/skrollr/skrollr.min"},shim:{tweenMax:{exports:"TweenMax"},preloadjs:{exports:"createjs.LoadQueue"}}}),require(["app","desktop","common/analytics","newsBanner"],function(e,t,n,r){e.newsBanner=new r,e.desktop=new t,e.analytics=new n,e.newsBanner=new r}),define("main-desktop",function(){});
